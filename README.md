# Dog walk app

Приложение для бронирования прогулок с собакой.

### Содержание:

* [Инструкция для запуска](#инструкция-для-запуска)
  * [Локально в режиме дебага через poetry](#локально-в-режиме-дебага-через-poetry)
  * [Локально в режиме дебага через pip](#локально-в-режиме-дебага-через-pip)
  * [Через docker compose вместе с БД](#через-docker-compose-вместе-с-бд)
  * [Через docker compose без БД](#через-docker-compose-без-бд)
* [Переменные окружения](#переменные-окружения)
  * [База данных](#база-данных)
  * [Порт для докера](#порт-для-docker)
* [Краткое описание API (документацию можно найти в swagger)](#краткое-описание-api-документацию-можно-найти-в-swagger)
  * [Добавление Order](#добавление-order)
  * [Получение Orders](#получение-order)
* [Сущности](#сущности)
  * [Order](#order---заказ)
* [Описание технологий](#описание-технологий)

## Инструкция для запуска

### Локально в режиме дебага через poetry

Требования:
* Установлен python 3.12.
* Установлен poetry.
* Установлен плагин для Makefile (если его нет, можно скопировать команду в нем).
* Указаны переменные окружения в `.env` файле в корне проекта
согласно разделу **Переменные окружения**.

Инструкция:
* Активируйте окружение командой `poetry shell`.
* Установите зависимости командой `poetry install`.
* Выполните миграцию базы данных командой `make migration`.
* Запустите приложение командой `make`.

### Локально в режиме дебага через pip

Требования:
* Установлен python 3.12.
* Указаны переменные окружения в `.env` файле в корне проекта
согласно разделу **Переменные окружения**.

Инструкция:
* Установите зависимости командой `python -m venv venv`.
* Активируйте окружение командой `pip install -r build-dependencies`.
* Выполните миграцию базы данных командой `make migration`.
* Запустите приложение командой `make`.
* Для запуска тестов используйте команду `pytest`.

### Через docker compose вместе с БД

Требования:
* Установлен docker compose.
* Указаны переменные окружения в `.env` файле в корне проекта
согласно разделу **Переменные окружения**.

Инструкция для windows:

* Разверните командой `docker-compose up`.

Инструкция для linux:
* Разверните командой `docker compose up`.

### Через docker compose без БД

Требования:
* Установлен docker compose.
* Указаны переменные окружения в `.env` файле в корне проекта
согласно разделу **Переменные окружения**.

Инструкция для windows:
* Разверните командой `docker-compose -f compose-no-db.yaml up`.

Инструкция для linux:
* Разверните командой `docker compose -f compose-no-db.yaml up`.

## Переменные окружения

Для запуска приложения необходимо указать переменные окружения
в корневой директории в `.env` файле.

### База данных

* `POSTGRES_USER` - имя пользователя.
* `POSTGRES_PASSWORD` - пароль пользователя.
* `POSTGRES_PORT` - порт базы данных.
* `POSTGRES_NAME` - имя базы данных.
* `POSTGRES_HOST` - хост базы данных.
  * Если вы разворачиваете через **docker compose** вместе с базой данных, то эта переменная необязательна
и будет проигнорирована, вместо нее используется имя контейнера `db`.
  * Если вы разворачиваете через **docker compose** без базы данных и используете локальную БД,
то `localhost` следует заменить на`host.docker.internal`.
```dotenv
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_NAME=dog_walk_app
```
### Порт для Docker

* `BACKEND_PORT` - внешний порт для бекенда.
```dotenv
BACKEND_PORT=8000
```


## Краткое описание API (документацию можно найти в swagger)

### Добавление ***Order***.
Забронировать прогулку с собакой

### Получение ***Order***.
Получить список забронированных прогулок на выбранную дату.

## Сущности

### ***Order*** - заказ.

```json
{
  "id":  "24d279be-76dc-40d1-a827-411466371fd4",
  "flat":  "11",
  "dog":  {
    "breed": "Алабай",
    "name": "Бобик"
  },
  "walker":  "PETR",
  "walk_date":  "2024-12-22",
  "walk_time": "10:00"
}
```

## Описание технологий

* ✅ Версия Python 3.12.
* ✅ Интеграционные и юнит тесты `pytest`.
* ✅ База данных `Postgres`.
* ✅ ORM `SQLAlchemy` + `SQLModel`.
* ✅ Миграции для базы данных через `alembic`.
* ✅ Прекомит хуки.
* ✅ Конфигурация проекта с помощью `nitpick`.
* ✅ Возможность конфигурации через переменные окружения.
* ✅ Наличие `README` файла с инструкцией по запуску, описанием доступных настроек и описанием API.
* ✅ Наличие `Dockerfile` для запуска контейнера с сервисом.
* ✅ Наличие `docker-compose.yaml` для запуска сервиса и postgresql.
